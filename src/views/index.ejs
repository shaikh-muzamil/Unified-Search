<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Workspace Search</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <%- include('partials/header', { user: user }) %>

        <main class="main-content container">
            <section class="hero" style="text-align: center; padding: 60px 0 40px;">
                <h1 style="margin-bottom: 16px;">Unified Workspace Search</h1>
                <p
                    style="font-size: 1.25rem; color: var(--text-secondary); margin-bottom: 40px; max-width: 600px; margin-left: auto; margin-right: auto;">
                    Seamlessly search across your Slack conversations and Notion documents in one place.
                </p>

                <form action="/search" method="GET" style="max-width: 600px; margin: 0 auto; position: relative;">
                    <input type="text" name="q" placeholder="What are you looking for?" value="<%= query %>" required
                        style="padding: 20px 24px; font-size: 1.1rem; border-radius: 50px; box-shadow: var(--shadow-soft); border: 1px solid transparent;">
                    <button type="submit" class="btn btn-primary"
                        style="position: absolute; right: 8px; top: 8px; bottom: 8px; border-radius: 40px; padding: 0 32px;">
                        Search
                    </button>
                </form>
            </section>

            <% if (results) { %>
                <div class="results-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 40px; margin-top: 40px;">

                    <!-- Slack Column -->
                    <div class="column slack-column">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                            <span style="font-size: 1.5rem;">üí¨</span>
                            <h3>Slack Results</h3>
                        </div>

                        <% if (results.slack && results.slack.length> 0) { %>
                            <div style="display: flex; flex-direction: column; gap: 20px;">
                                <% results.slack.forEach(item=> { %>
                                    <a href="<%= item.permalink %>" target="_blank" class="card"
                                        style="display: block; text-decoration: none; color: inherit; padding: 24px;">
                                        <div
                                            style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                            <strong style="color: var(--text-primary);">
                                                <%= item.user %>
                                            </strong>
                                            <span class="badge"
                                                style="background: #E0E7FF; color: #3730A3; font-size: 0.75rem;">#<%=
                                                    item.channel %></span>
                                        </div>
                                        <p
                                            style="color: var(--text-secondary); margin-bottom: 16px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                            <%= item.text %>
                                        </p>
                                        <span style="font-size: 0.85rem; color: #9CA3AF;">
                                            <%= new Date(item.ts * 1000).toLocaleDateString() %>
                                        </span>
                                    </a>
                                    <% }) %>
                            </div>
                            <% } else { %>
                                <div class="card"
                                    style="text-align: center; color: var(--text-secondary); padding: 40px;">
                                    No results found in Slack.
                                </div>
                                <% } %>
                    </div>

                    <!-- Notion Column -->
                    <div class="column notion-column">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                            <span style="font-size: 1.5rem;">üìù</span>
                            <h3>Notion Results</h3>
                        </div>

                        <% if (results.notion && results.notion.length> 0) { %>
                            <div style="display: flex; flex-direction: column; gap: 20px;">
                                <% results.notion.forEach(item=> { %>
                                    <a href="<%= item.url %>" target="_blank" class="card"
                                        style="display: block; text-decoration: none; color: inherit; padding: 24px;">
                                        <div
                                            style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
                                            <span style="font-size: 1.25rem;">
                                                <%= item.icon || 'üìÑ' %>
                                            </span>
                                            <strong
                                                style="font-size: 1.1rem; color: var(--text-primary); line-height: 1.4;">
                                                <%= item.title %>
                                            </strong>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <span class="badge"
                                                style="background: #F3E8FF; color: #6B21A8; font-size: 0.75rem;">
                                                <%= item.object %>
                                            </span>
                                        </div>
                                    </a>
                                    <% }) %>
                            </div>
                            <% } else { %>
                                <div class="card"
                                    style="text-align: center; color: var(--text-secondary); padding: 40px;">
                                    No results found in Notion.
                                </div>
                                <% } %>
                    </div>
                </div>
                <% } %>
        </main>
</body>

</html>